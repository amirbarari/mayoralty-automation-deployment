import{d as ce,e as de,f as ze,g as Ce,h as ge,i as fe,j as _e}from"./chunk-WRUICC57.js";import"./chunk-S76HEK6X.js";import{b as he}from"./chunk-WLIVQ3RG.js";import"./chunk-2SBPQ5PO.js";import{a as be,b as Oe,c as Me,d as ve,e as ye}from"./chunk-YOIS5LYM.js";import{a as ee,b as ne,c as ie}from"./chunk-GAPH4TJR.js";import"./chunk-K62VDMMU.js";import{a as W,b as q}from"./chunk-JLK6BMKQ.js";import"./chunk-3GG5JXOG.js";import{a as me,b as pe}from"./chunk-M7BDISBG.js";import{a as re,b as ae,c as le}from"./chunk-S6C6MKMF.js";import{a as h}from"./chunk-DEEABJD6.js";import{f as te,g as oe,h as ue}from"./chunk-UQPNZCHR.js";import"./chunk-PZ3WQJJL.js";import{b as se}from"./chunk-R7V4VY4G.js";import{$ as X,L as H,M as C,O as $,P as J,T as R,W as K,Y as Q,aa as Y,ba as Z}from"./chunk-WURTGZ7Q.js";import{f as U,g as G,h as B,i as L}from"./chunk-4RJVJPSO.js";import{r as D,x as I,xa as k,ya as j}from"./chunk-7PNVVBYH.js";import"./chunk-MHGKYAZL.js";import"./chunk-FHD2U5CN.js";import{Ca as s,Da as m,Ec as E,Fb as S,Fc as r,Gc as P,H as x,Jc as T,Kc as N,Lb as O,Lc as V,Tb as p,Uc as w,dc as f,ec as _,fc as i,gc as n,hc as c,ic as y,jc as A,lc as F,rb as l,rc as g,tc as M,wb as b}from"./chunk-Q7WSBUFH.js";var v=(o,t)=>t.id;function Fe(o,t){o&1&&c(0,"span",22)}function Te(o,t){if(o&1){let e=F();i(0,"tr")(1,"td"),r(2),n(),i(3,"td",23)(4,"button",24),r(5," \u0648\u06CC\u0631\u0627\u06CC\u0634 "),n(),i(6,"button",25),g("nzOnConfirm",function(){let a=s(e).$implicit,d=M();return m(d.deleteOrganization(a.id))}),r(7," \u062D\u0630\u0641 "),n()()()}if(o&2){let e=t.$implicit;l(2),P(e.name)}}function Ne(o,t){if(o&1&&(y(0),i(1,"p",26),r(2,"\u0633\u0627\u0632\u0645\u0627\u0646 \u062C\u062F\u06CC\u062F\u06CC \u0628\u0647 \u0633\u06CC\u0633\u062A\u0645 \u0627\u0636\u0627\u0641\u0647 \u06A9\u0646\u06CC\u062F."),n(),i(3,"form",27)(4,"nz-form-item")(5,"nz-form-label",28),r(6,"\u0646\u0627\u0645 \u0633\u0627\u0632\u0645\u0627\u0646"),n(),i(7,"nz-form-control",29),c(8,"input",30),n()()(),A()),o&2){let e=M();l(3),p("formGroup",e.organizationForm)}}function Ve(o,t){if(o&1&&c(0,"nz-option",33),o&2){let e=t.$implicit;p("nzValue",e.id)("nzLabel",e.name)}}function xe(o,t){if(o&1&&c(0,"nz-option",33),o&2){let e=t.$implicit;p("nzValue",e.id)("nzLabel",e.name+" "+e.family)}}function Se(o,t){if(o&1&&c(0,"nz-option",33),o&2){let e=t.$implicit;p("nzValue",e.id)("nzLabel",e.name)}}function Ee(o,t){if(o&1&&(y(0),i(1,"p",26),r(2,"\u06CC\u06A9 \u0645\u0633\u0626\u0648\u0644 \u0628\u0647 \u0633\u0627\u0632\u0645\u0627\u0646 \u0645\u0648\u0631\u062F \u0646\u0638\u0631 \u0627\u062E\u062A\u0635\u0627\u0635 \u062F\u0647\u06CC\u062F."),n(),i(3,"form",27)(4,"nz-form-item")(5,"nz-form-label",28),r(6,"\u0633\u0627\u0632\u0645\u0627\u0646"),n(),i(7,"nz-form-control",31)(8,"nz-select",32),f(9,Ve,1,2,"nz-option",33,v),n()()(),i(11,"nz-form-item")(12,"nz-form-label",28),r(13,"\u06A9\u0627\u0631\u0628\u0631"),n(),i(14,"nz-form-control",34)(15,"nz-select",35),f(16,xe,1,2,"nz-option",33,v),n()()(),i(18,"nz-form-item")(19,"nz-form-label",28),r(20,"\u0646\u0648\u0639 \u0633\u0645\u062A"),n(),i(21,"nz-form-control",36)(22,"nz-select",37),f(23,Se,1,2,"nz-option",33,v),n()()(),i(25,"nz-form-item")(26,"nz-form-label",28),r(27,"\u0634\u0645\u0627\u0631\u0647 \u062A\u0644\u0641\u0646"),n(),i(28,"nz-form-control",38),c(29,"input",39),n()()(),A()),o&2){let e=M();l(3),p("formGroup",e.assignmentForm),l(6),_(e.organizations),l(7),_(e.persons),l(7),_(e.jobPostTypes)}}var Ae=class o{constructor(t,e,u){this.fb=t;this.notification=e;this.http=u}isOrganizationModalVisible=!1;isAssignmentModalVisible=!1;organizationForm;assignmentForm;organizations=[];persons=[];jobPostTypes=[];organizationApiUrl=h.endpoints.organization;personApiUrl=h.endpoints.person;jobPostTypeApiUrl=h.endpoints.jobPostType;jobPostAssignmentApiUrl=h.endpoints.jobPostAssignment;ngOnInit(){this.loadInitialData(),this.organizationForm=this.fb.group({name:["",[C.required]]}),this.assignmentForm=this.fb.group({organizationId:[null,[C.required]],userId:[null,[C.required]],jobPostTypeId:[null,[C.required]],phoneNumber:["",[C.required,C.pattern(/^[0-9]+$/)]]})}loadInitialData(){x({organizations:this.http.get(this.organizationApiUrl),persons:this.http.get(this.personApiUrl),jobPostTypes:this.http.get(this.jobPostTypeApiUrl)}).subscribe({next:({organizations:t,persons:e,jobPostTypes:u})=>{this.organizations=t,this.persons=e,this.jobPostTypes=u.filter(a=>a.party_type_id===2)},error:t=>{this.notification.error("\u062E\u0637\u0627","\u062F\u0631\u06CC\u0627\u0641\u062A \u0627\u0637\u0644\u0627\u0639\u0627\u062A \u0627\u0648\u0644\u06CC\u0647 \u0628\u0627 \u0645\u0634\u06A9\u0644 \u0645\u0648\u0627\u062C\u0647 \u0634\u062F."),console.error(t)}})}showOrganizationModal(){this.organizationForm.reset(),this.isOrganizationModalVisible=!0}handleOrganizationOk(){this.organizationForm.valid?this.http.post(this.organizationApiUrl,this.organizationForm.value).subscribe({next:()=>{this.notification.success("\u0645\u0648\u0641\u0642","\u0633\u0627\u0632\u0645\u0627\u0646 \u062C\u062F\u06CC\u062F \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0627\u06CC\u062C\u0627\u062F \u0634\u062F."),this.isOrganizationModalVisible=!1,this.loadInitialData()},error:t=>{this.notification.error("\u062E\u0637\u0627","\u0627\u06CC\u062C\u0627\u062F \u0633\u0627\u0632\u0645\u0627\u0646 \u062C\u062F\u06CC\u062F \u0628\u0627 \u0645\u0634\u06A9\u0644 \u0645\u0648\u0627\u062C\u0647 \u0634\u062F."),console.error(t)}}):this.validateForm(this.organizationForm)}handleOrganizationCancel(){this.isOrganizationModalVisible=!1}deleteOrganization(t){let e=`${this.organizationApiUrl}${t}/`;this.http.delete(e).subscribe({next:()=>{this.notification.info("\u062D\u0630\u0641 \u0634\u062F","\u0633\u0627\u0632\u0645\u0627\u0646 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u06AF\u0631\u062F\u06CC\u062F."),this.loadInitialData()},error:u=>{this.notification.error("\u062E\u0637\u0627","\u062D\u0630\u0641 \u0633\u0627\u0632\u0645\u0627\u0646 \u0628\u0627 \u0645\u0634\u06A9\u0644 \u0645\u0648\u0627\u062C\u0647 \u0634\u062F."),console.error(u)}})}showAssignmentModal(){this.assignmentForm.reset(),this.isAssignmentModalVisible=!0}handleAssignmentOk(){if(this.assignmentForm.valid){let t={party_id:Number(this.assignmentForm.value.organizationId),person_id:Number(this.assignmentForm.value.userId),job_post_type_id:Number(this.assignmentForm.value.jobPostTypeId),phone:this.assignmentForm.value.phoneNumber};this.http.post(this.jobPostAssignmentApiUrl,t).subscribe({next:()=>{this.notification.success("\u0645\u0648\u0641\u0642","\u0641\u0631\u062F \u062C\u062F\u06CC\u062F \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0628\u0647 \u0633\u0627\u0632\u0645\u0627\u0646 \u0627\u062E\u062A\u0635\u0627\u0635 \u062F\u0627\u062F\u0647 \u0634\u062F."),this.isAssignmentModalVisible=!1},error:e=>{this.notification.error("\u062E\u0637\u0627","\u0627\u062E\u062A\u0635\u0627\u0635 \u0645\u0633\u0626\u0648\u0644 \u0628\u0627 \u0645\u0634\u06A9\u0644 \u0645\u0648\u0627\u062C\u0647 \u0634\u062F."),console.error(e)}})}else this.validateForm(this.assignmentForm)}handleAssignmentCancel(){this.isAssignmentModalVisible=!1}validateForm(t){Object.values(t.controls).forEach(e=>{e.invalid&&(e.markAsDirty(),e.updateValueAndValidity({onlySelf:!0}))})}static \u0275fac=function(e){return new(e||o)(b(X),b(se),b(I))};static \u0275cmp=S({type:o,selectors:[["app-municipal-organizations"]],decls:41,vars:9,consts:[["suffixIconSearch",""],["organizationsTable",""],[1,"organizations-page"],[1,"page-header"],[1,"header-title"],[1,"header-actions"],[1,"dark-search-input"],["nzSearch","",3,"nzAddOnAfter"],["type","text","nz-input","","placeholder","\u062C\u0633\u062A\u062C\u0648\u06CC \u0633\u0627\u0632\u0645\u0627\u0646\u200C\u0647\u0627..."],["nz-button","","nzType","primary","nzShape","round",3,"click"],["nz-icon","","nzType","user-add"],["nz-icon","","nzType","plus"],[1,"custom-card"],[1,"custom-card__header"],[1,"custom-card__title"],[1,"custom-card__subtitle"],[1,"custom-card__body"],[1,"financial-table",3,"nzData","nzSize"],[1,"actions-header"],["nzTitle","\u0633\u0627\u0632\u0645\u0627\u0646 \u062C\u062F\u06CC\u062F",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzOkText","nzCancelText"],[4,"nzModalContent"],["nzTitle","\u0627\u062E\u062A\u0635\u0627\u0635 \u0645\u0633\u0626\u0648\u0644 \u0628\u0647 \u0633\u0627\u0632\u0645\u0627\u0646",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzOkText","nzCancelText"],["nz-icon","","nzType","search"],[1,"actions"],["nz-button","","nzShape","round","nzType","primary","nzSize","small"],["nz-button","","nzDanger","","nzShape","round","nzType","primary","nzSize","small","nz-popconfirm","","nzPopconfirmTitle","\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u0633\u0627\u0632\u0645\u0627\u0646 \u0645\u0637\u0645\u0626\u0646 \u0647\u0633\u062A\u06CC\u062F\u061F",3,"nzOnConfirm"],[1,"modal-subtitle"],["nz-form","",1,"modal-form",3,"formGroup"],["nzRequired",""],["nzErrorTip","\u0644\u0637\u0641\u0627 \u0646\u0627\u0645 \u0633\u0627\u0632\u0645\u0627\u0646 \u0631\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F"],["nz-input","","formControlName","name","placeholder","\u0645\u062B\u0627\u0644: \u0633\u0627\u0632\u0645\u0627\u0646 \u062D\u0645\u0644 \u0648 \u0646\u0642\u0644"],["nzErrorTip","\u0644\u0637\u0641\u0627 \u0633\u0627\u0632\u0645\u0627\u0646 \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"],["formControlName","organizationId","nzPlaceHolder","\u0633\u0627\u0632\u0645\u0627\u0646 \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"],[3,"nzValue","nzLabel"],["nzErrorTip","\u0644\u0637\u0641\u0627 \u06A9\u0627\u0631\u0628\u0631 \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"],["formControlName","userId","nzPlaceHolder","\u06A9\u0627\u0631\u0628\u0631 \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"],["nzErrorTip","\u0644\u0637\u0641\u0627 \u0646\u0648\u0639 \u0633\u0645\u062A \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"],["formControlName","jobPostTypeId","nzPlaceHolder","\u0646\u0648\u0639 \u0633\u0645\u062A \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"],["nzErrorTip","\u0644\u0637\u0641\u0627 \u0634\u0645\u0627\u0631\u0647 \u062A\u0644\u0641\u0646 \u0631\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F"],["nz-input","","formControlName","phoneNumber","placeholder","\u0645\u062B\u0627\u0644: 09123456789"]],template:function(e,u){if(e&1){let a=F();i(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1"),r(4,"\u0633\u0627\u0632\u0645\u0627\u0646\u200C\u0647\u0627\u06CC \u0634\u0647\u0631\u062F\u0627\u0631\u06CC"),n(),i(5,"p"),r(6,"\u0645\u062F\u06CC\u0631\u06CC\u062A \u0633\u0627\u0632\u0645\u0627\u0646\u200C\u0647\u0627\u06CC \u0645\u0631\u0628\u0648\u0637 \u0628\u0647 \u0634\u0647\u0631\u062F\u0627\u0631\u06CC"),n()(),i(7,"div",5)(8,"div",6)(9,"nz-input-group",7),c(10,"input",8),n(),O(11,Fe,1,0,"ng-template",null,0,w),n(),i(13,"button",9),g("click",function(){return s(a),m(u.showAssignmentModal())}),c(14,"span",10),r(15," \u0627\u062E\u062A\u0635\u0627\u0635 \u0645\u0633\u0626\u0648\u0644 "),n(),i(16,"button",9),g("click",function(){return s(a),m(u.showOrganizationModal())}),c(17,"span",11),r(18," \u0633\u0627\u0632\u0645\u0627\u0646 \u062C\u062F\u06CC\u062F "),n()()(),i(19,"div",12)(20,"div",13)(21,"h2",14),r(22,"\u0644\u06CC\u0633\u062A \u0633\u0627\u0632\u0645\u0627\u0646\u200C\u0647\u0627"),n(),i(23,"p",15),r(24,"\u062A\u0645\u0627\u0645 \u0633\u0627\u0632\u0645\u0627\u0646\u200C\u0647\u0627\u06CC \u062A\u0639\u0631\u06CC\u0641 \u0634\u062F\u0647 \u062F\u0631 \u0633\u06CC\u0633\u062A\u0645"),n()(),i(25,"div",16)(26,"nz-table",17,1)(28,"thead")(29,"tr")(30,"th"),r(31,"\u0646\u0627\u0645 \u0633\u0627\u0632\u0645\u0627\u0646"),n(),i(32,"th",18),r(33,"\u0639\u0645\u0644\u06CC\u0627\u062A"),n()()(),i(34,"tbody"),f(35,Te,8,1,"tr",null,v),n()()()()(),i(37,"nz-modal",19),V("nzVisibleChange",function(z){return s(a),N(u.isOrganizationModalVisible,z)||(u.isOrganizationModalVisible=z),m(z)}),g("nzOnCancel",function(){return s(a),m(u.handleOrganizationCancel())})("nzOnOk",function(){return s(a),m(u.handleOrganizationOk())}),O(38,Ne,9,1,"ng-container",20),n(),i(39,"nz-modal",21),V("nzVisibleChange",function(z){return s(a),N(u.isAssignmentModalVisible,z)||(u.isAssignmentModalVisible=z),m(z)}),g("nzOnCancel",function(){return s(a),m(u.handleAssignmentCancel())})("nzOnOk",function(){return s(a),m(u.handleAssignmentOk())}),O(40,Ee,30,1,"ng-container",20),n()}if(e&2){let a=E(12);l(9),p("nzAddOnAfter",a),l(17),p("nzData",u.organizations)("nzSize","middle"),l(9),_(u.organizations),l(2),T("nzVisible",u.isOrganizationModalVisible),p("nzOkText","\u0630\u062E\u06CC\u0631\u0647")("nzCancelText","\u0627\u0646\u0635\u0631\u0627\u0641"),l(2),T("nzVisible",u.isAssignmentModalVisible),p("nzOkText","\u0630\u062E\u06CC\u0631\u0647")("nzCancelText","\u0627\u0646\u0635\u0631\u0627\u0641")}},dependencies:[D,Y,R,H,$,J,Z,K,Q,L,B,U,G,j,k,ue,te,oe,_e,Ce,ce,de,fe,ze,ge,le,ae,re,ye,q,W,Oe,be,ve,Me,ie,ee,ne,pe,me,he],styles:[".organizations-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;padding:2rem;height:100%}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1.5rem}.page-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.75rem;font-weight:600}.page-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0 0}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.dark-search-input[_ngcontent-%COMP%]{min-width:250px}.custom-card[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.custom-card__body[_ngcontent-%COMP%]{overflow-x:auto}.financial-table[_ngcontent-%COMP%]   .actions-header[_ngcontent-%COMP%]{text-align:center}.financial-table[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:.5rem;flex-wrap:nowrap}.modal-subtitle[_ngcontent-%COMP%]{margin-top:-10px;margin-bottom:24px}"]})};export{Ae as MunicipalOrgsComponent};
