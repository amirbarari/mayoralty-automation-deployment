import{d as se,e as pe,f as ce,g as de,h as Ce,i as ze,j as fe}from"./chunk-PHG3VJEM.js";import"./chunk-HNORQ23J.js";import"./chunk-2SBPQ5PO.js";import{a as _e,b as he,c as Ae,d as ye,e as be}from"./chunk-TS3NV7FJ.js";import{a as ee,b as ne,c as te}from"./chunk-Y7V7LVZY.js";import"./chunk-K62VDMMU.js";import{a as W,b as q}from"./chunk-JLK6BMKQ.js";import"./chunk-3GG5JXOG.js";import{a as re,b as ae,c as me}from"./chunk-POH2GVPE.js";import{a as A}from"./chunk-DEEABJD6.js";import{f as ie,g as oe,h as ue}from"./chunk-BEYQRRZ4.js";import"./chunk-EWNZSDQ6.js";import{b as le}from"./chunk-BVLOTES5.js";import{$ as Y,L as H,M as z,O as $,P as J,S as R,V as K,X as Q,_ as X,aa as Z}from"./chunk-KM43CBUV.js";import{f as U,g as G,h as B,i as L}from"./chunk-4RJVJPSO.js";import{r as I,x as D,xa as k,ya as j}from"./chunk-7PNVVBYH.js";import"./chunk-MHGKYAZL.js";import"./chunk-FHD2U5CN.js";import{Ca as l,Da as s,Ec as E,Fb as S,Fc as r,Gc as P,H as x,Jc as N,Kc as O,Lb as b,Lc as V,Tb as p,Uc as w,dc as _,ec as h,fc as t,gc as n,hc as c,ic as v,jc as F,lc as T,rb as m,rc as f,tc as g,wb as y}from"./chunk-Q7WSBUFH.js";var M=(o,i)=>i.id;function Me(o,i){o&1&&c(0,"span",22)}function ve(o,i){if(o&1){let e=T();t(0,"tr")(1,"td"),r(2),n(),t(3,"td",23)(4,"button",24),r(5," \u0648\u06CC\u0631\u0627\u06CC\u0634 "),n(),t(6,"button",25),f("nzOnConfirm",function(){let a=l(e).$implicit,d=g();return s(d.deleteCompany(a.id))}),r(7," \u062D\u0630\u0641 "),n()()()}if(o&2){let e=i.$implicit;m(2),P(e.name)}}function Fe(o,i){if(o&1&&(v(0),t(1,"p",26),r(2,"\u0634\u0631\u06A9\u062A \u062C\u062F\u06CC\u062F\u06CC \u0628\u0647 \u0633\u06CC\u0633\u062A\u0645 \u0627\u0636\u0627\u0641\u0647 \u06A9\u0646\u06CC\u062F."),n(),t(3,"form",27)(4,"nz-form-item")(5,"nz-form-label",28),r(6,"\u0646\u0627\u0645 \u0634\u0631\u06A9\u062A"),n(),t(7,"nz-form-control",29),c(8,"input",30),n()()(),F()),o&2){let e=g();m(3),p("formGroup",e.companyForm)}}function Te(o,i){if(o&1&&c(0,"nz-option",33),o&2){let e=i.$implicit;p("nzValue",e.id)("nzLabel",e.name)}}function Ne(o,i){if(o&1&&c(0,"nz-option",33),o&2){let e=i.$implicit;p("nzValue",e.id)("nzLabel",e.name+" "+e.family)}}function Oe(o,i){if(o&1&&c(0,"nz-option",33),o&2){let e=i.$implicit;p("nzValue",e.id)("nzLabel",e.name)}}function Ve(o,i){if(o&1&&(v(0),t(1,"p",26),r(2,"\u06CC\u06A9 \u0645\u0633\u0626\u0648\u0644 \u0628\u0647 \u0634\u0631\u06A9\u062A \u0645\u0648\u0631\u062F \u0646\u0638\u0631 \u0627\u062E\u062A\u0635\u0627\u0635 \u062F\u0647\u06CC\u062F."),n(),t(3,"form",27)(4,"nz-form-item")(5,"nz-form-label",28),r(6,"\u0634\u0631\u06A9\u062A"),n(),t(7,"nz-form-control",31)(8,"nz-select",32),_(9,Te,1,2,"nz-option",33,M),n()()(),t(11,"nz-form-item")(12,"nz-form-label",28),r(13,"\u06A9\u0627\u0631\u0628\u0631"),n(),t(14,"nz-form-control",34)(15,"nz-select",35),_(16,Ne,1,2,"nz-option",33,M),n()()(),t(18,"nz-form-item")(19,"nz-form-label",28),r(20,"\u0646\u0648\u0639 \u0633\u0645\u062A"),n(),t(21,"nz-form-control",36)(22,"nz-select",37),_(23,Oe,1,2,"nz-option",33,M),n()()(),t(25,"nz-form-item")(26,"nz-form-label",28),r(27,"\u0634\u0645\u0627\u0631\u0647 \u062A\u0644\u0641\u0646"),n(),t(28,"nz-form-control",38),c(29,"input",39),n()()(),F()),o&2){let e=g();m(3),p("formGroup",e.assignmentForm),m(6),h(e.companies),m(7),h(e.persons),m(7),h(e.jobPostTypes)}}var ge=class o{constructor(i,e,u){this.fb=i;this.notification=e;this.http=u}isCompanyModalVisible=!1;isAssignmentModalVisible=!1;companyForm;assignmentForm;companies=[];persons=[];jobPostTypes=[];companyApiUrl=A.endpoints.company;personApiUrl=A.endpoints.person;jobPostTypeApiUrl=A.endpoints.jobPostType;jobPostAssignmentApiUrl=A.endpoints.jobPostAssignment;ngOnInit(){this.loadInitialData(),this.companyForm=this.fb.group({name:["",[z.required]]}),this.assignmentForm=this.fb.group({companyId:[null,[z.required]],userId:[null,[z.required]],jobPostTypeId:[null,[z.required]],phoneNumber:["",[z.required,z.pattern(/^[0-9]+$/)]]})}loadInitialData(){x({companies:this.http.get(this.companyApiUrl),persons:this.http.get(this.personApiUrl),jobPostTypes:this.http.get(this.jobPostTypeApiUrl)}).subscribe({next:({companies:i,persons:e,jobPostTypes:u})=>{this.companies=i,this.persons=e,this.jobPostTypes=u.filter(a=>a.party_type_id===3)},error:i=>{this.notification.error("\u062E\u0637\u0627","\u062F\u0631\u06CC\u0627\u0641\u062A \u0627\u0637\u0644\u0627\u0639\u0627\u062A \u0627\u0648\u0644\u06CC\u0647 \u0628\u0627 \u0645\u0634\u06A9\u0644 \u0645\u0648\u0627\u062C\u0647 \u0634\u062F."),console.error(i)}})}showCompanyModal(){this.companyForm.reset(),this.isCompanyModalVisible=!0}handleCompanyOk(){this.companyForm.valid?this.http.post(this.companyApiUrl,this.companyForm.value).subscribe({next:()=>{this.notification.success("\u0645\u0648\u0641\u0642","\u0634\u0631\u06A9\u062A \u062C\u062F\u06CC\u062F \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0627\u06CC\u062C\u0627\u062F \u0634\u062F."),this.isCompanyModalVisible=!1,this.loadInitialData()},error:i=>{this.notification.error("\u062E\u0637\u0627","\u0627\u06CC\u062C\u0627\u062F \u0634\u0631\u06A9\u062A \u062C\u062F\u06CC\u062F \u0628\u0627 \u0645\u0634\u06A9\u0644 \u0645\u0648\u0627\u062C\u0647 \u0634\u062F."),console.error(i)}}):this.validateForm(this.companyForm)}handleCompanyCancel(){this.isCompanyModalVisible=!1}deleteCompany(i){let e=`${this.companyApiUrl}${i}/`;this.http.delete(e).subscribe({next:()=>{this.notification.info("\u062D\u0630\u0641 \u0634\u062F","\u0634\u0631\u06A9\u062A \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u06AF\u0631\u062F\u06CC\u062F."),this.loadInitialData()},error:u=>{this.notification.error("\u062E\u0637\u0627","\u062D\u0630\u0641 \u0634\u0631\u06A9\u062A \u0628\u0627 \u0645\u0634\u06A9\u0644 \u0645\u0648\u0627\u062C\u0647 \u0634\u062F."),console.error(u)}})}showAssignmentModal(){this.assignmentForm.reset(),this.isAssignmentModalVisible=!0}handleAssignmentOk(){if(this.assignmentForm.valid){let i={party_id:Number(this.assignmentForm.value.companyId),person_id:Number(this.assignmentForm.value.userId),job_post_type_id:Number(this.assignmentForm.value.jobPostTypeId),phone:this.assignmentForm.value.phoneNumber};this.http.post(this.jobPostAssignmentApiUrl,i).subscribe({next:()=>{this.notification.success("\u0645\u0648\u0641\u0642","\u0641\u0631\u062F \u062C\u062F\u06CC\u062F \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0628\u0647 \u0634\u0631\u06A9\u062A \u0627\u062E\u062A\u0635\u0627\u0635 \u062F\u0627\u062F\u0647 \u0634\u062F."),this.isAssignmentModalVisible=!1},error:e=>{this.notification.error("\u062E\u0637\u0627","\u0627\u062E\u062A\u0635\u0627\u0635 \u0645\u0633\u0626\u0648\u0644 \u0628\u0627 \u0645\u0634\u06A9\u0644 \u0645\u0648\u0627\u062C\u0647 \u0634\u062F."),console.error(e)}})}else this.validateForm(this.assignmentForm)}handleAssignmentCancel(){this.isAssignmentModalVisible=!1}validateForm(i){Object.values(i.controls).forEach(e=>{e.invalid&&(e.markAsDirty(),e.updateValueAndValidity({onlySelf:!0}))})}static \u0275fac=function(e){return new(e||o)(y(X),y(le),y(D))};static \u0275cmp=S({type:o,selectors:[["app-municipal-companies"]],decls:41,vars:9,consts:[["suffixIconSearch",""],["companiesTable",""],[1,"companies-page"],[1,"page-header"],[1,"header-title"],[1,"header-actions"],[1,"dark-search-input"],["nzSearch","",3,"nzAddOnAfter"],["type","text","nz-input","","placeholder","\u062C\u0633\u062A\u062C\u0648\u06CC \u0634\u0631\u06A9\u062A\u200C\u0647\u0627..."],["nz-button","","nzType","primary","nzShape","round",3,"click"],["nz-icon","","nzType","user-add"],["nz-icon","","nzType","plus"],[1,"custom-card"],[1,"custom-card__header"],[1,"custom-card__title"],[1,"custom-card__subtitle"],[1,"custom-card__body"],[1,"financial-table",3,"nzData","nzSize"],[1,"actions-header"],["nzTitle","\u0634\u0631\u06A9\u062A \u062C\u062F\u06CC\u062F",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzOkText","nzCancelText"],[4,"nzModalContent"],["nzTitle","\u0627\u062E\u062A\u0635\u0627\u0635 \u0645\u0633\u0626\u0648\u0644 \u0628\u0647 \u0634\u0631\u06A9\u062A",3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzOkText","nzCancelText"],["nz-icon","","nzType","search"],[1,"actions"],["nz-button","","nzShape","round","nzType","primary","nzSize","small"],["nz-button","","nzDanger","","nzShape","round","nzType","primary","nzSize","small","nz-popconfirm","","nzPopconfirmTitle","\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u0634\u0631\u06A9\u062A \u0645\u0637\u0645\u0626\u0646 \u0647\u0633\u062A\u06CC\u062F\u061F",3,"nzOnConfirm"],[1,"modal-subtitle"],["nz-form","",1,"modal-form",3,"formGroup"],["nzRequired",""],["nzErrorTip","\u0644\u0637\u0641\u0627 \u0646\u0627\u0645 \u0634\u0631\u06A9\u062A \u0631\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F"],["nz-input","","formControlName","name","placeholder","\u0645\u062B\u0627\u0644: \u0634\u0631\u06A9\u062A \u0622\u0628 \u0648 \u0641\u0627\u0636\u0644\u0627\u0628"],["nzErrorTip","\u0644\u0637\u0641\u0627 \u0634\u0631\u06A9\u062A \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"],["formControlName","companyId","nzPlaceHolder","\u0634\u0631\u06A9\u062A \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"],[3,"nzValue","nzLabel"],["nzErrorTip","\u0644\u0637\u0641\u0627 \u06A9\u0627\u0631\u0628\u0631 \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"],["formControlName","userId","nzPlaceHolder","\u06A9\u0627\u0631\u0628\u0631 \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"],["nzErrorTip","\u0644\u0637\u0641\u0627 \u0646\u0648\u0639 \u0633\u0645\u062A \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"],["formControlName","jobPostTypeId","nzPlaceHolder","\u0646\u0648\u0639 \u0633\u0645\u062A \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"],["nzErrorTip","\u0644\u0637\u0641\u0627 \u0634\u0645\u0627\u0631\u0647 \u062A\u0644\u0641\u0646 \u0631\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F"],["nz-input","","formControlName","phoneNumber","placeholder","\u0645\u062B\u0627\u0644: 09123456789"]],template:function(e,u){if(e&1){let a=T();t(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1"),r(4,"\u0634\u0631\u06A9\u062A\u200C\u0647\u0627\u06CC \u0634\u0647\u0631\u062F\u0627\u0631\u06CC"),n(),t(5,"p"),r(6,"\u0645\u062F\u06CC\u0631\u06CC\u062A \u0634\u0631\u06A9\u062A\u200C\u0647\u0627\u06CC \u0645\u0631\u0628\u0648\u0637 \u0628\u0647 \u0634\u0647\u0631\u062F\u0627\u0631\u06CC"),n()(),t(7,"div",5)(8,"div",6)(9,"nz-input-group",7),c(10,"input",8),n(),b(11,Me,1,0,"ng-template",null,0,w),n(),t(13,"button",9),f("click",function(){return l(a),s(u.showAssignmentModal())}),c(14,"span",10),r(15," \u0627\u062E\u062A\u0635\u0627\u0635 \u0645\u0633\u0626\u0648\u0644 "),n(),t(16,"button",9),f("click",function(){return l(a),s(u.showCompanyModal())}),c(17,"span",11),r(18," \u0634\u0631\u06A9\u062A \u062C\u062F\u06CC\u062F "),n()()(),t(19,"div",12)(20,"div",13)(21,"h2",14),r(22,"\u0644\u06CC\u0633\u062A \u0634\u0631\u06A9\u062A\u200C\u0647\u0627"),n(),t(23,"p",15),r(24,"\u062A\u0645\u0627\u0645 \u0634\u0631\u06A9\u062A\u200C\u0647\u0627\u06CC \u062A\u0639\u0631\u06CC\u0641 \u0634\u062F\u0647 \u062F\u0631 \u0633\u06CC\u0633\u062A\u0645"),n()(),t(25,"div",16)(26,"nz-table",17,1)(28,"thead")(29,"tr")(30,"th"),r(31,"\u0646\u0627\u0645 \u0634\u0631\u06A9\u062A"),n(),t(32,"th",18),r(33,"\u0639\u0645\u0644\u06CC\u0627\u062A"),n()()(),t(34,"tbody"),_(35,ve,8,1,"tr",null,M),n()()()()(),t(37,"nz-modal",19),V("nzVisibleChange",function(C){return l(a),O(u.isCompanyModalVisible,C)||(u.isCompanyModalVisible=C),s(C)}),f("nzOnCancel",function(){return l(a),s(u.handleCompanyCancel())})("nzOnOk",function(){return l(a),s(u.handleCompanyOk())}),b(38,Fe,9,1,"ng-container",20),n(),t(39,"nz-modal",21),V("nzVisibleChange",function(C){return l(a),O(u.isAssignmentModalVisible,C)||(u.isAssignmentModalVisible=C),s(C)}),f("nzOnCancel",function(){return l(a),s(u.handleAssignmentCancel())})("nzOnOk",function(){return l(a),s(u.handleAssignmentOk())}),b(40,Ve,30,1,"ng-container",20),n()}if(e&2){let a=E(12);m(9),p("nzAddOnAfter",a),m(17),p("nzData",u.companies)("nzSize","middle"),m(9),h(u.companies),m(2),N("nzVisible",u.isCompanyModalVisible),p("nzOkText","\u0630\u062E\u06CC\u0631\u0647")("nzCancelText","\u0627\u0646\u0635\u0631\u0627\u0641"),m(2),N("nzVisible",u.isAssignmentModalVisible),p("nzOkText","\u0630\u062E\u06CC\u0631\u0647")("nzCancelText","\u0627\u0646\u0635\u0631\u0627\u0641")}},dependencies:[I,Y,R,H,$,J,Z,K,Q,L,B,U,G,j,k,ue,ie,oe,fe,de,se,pe,ze,ce,Ce,me,ae,re,be,q,W,he,_e,ye,Ae,te,ee,ne],styles:[".regions-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;padding:2rem;height:100%}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1.5rem}.page-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.75rem;font-weight:600}.page-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0 0}.page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.dark-search-input[_ngcontent-%COMP%]{min-width:250px}.custom-card[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.custom-card__body[_ngcontent-%COMP%]{overflow-x:auto}.financial-table[_ngcontent-%COMP%]   .actions-header[_ngcontent-%COMP%]{text-align:center}.financial-table[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:.5rem;flex-wrap:nowrap}.modal-subtitle[_ngcontent-%COMP%]{color:#94a3b8;margin-top:-10px;margin-bottom:24px}"]})};export{ge as MunicipalCompaniesComponent};
